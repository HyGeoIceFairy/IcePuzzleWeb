<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å†°å†°è°œ10 - CTF Challenge</title>
    <style>
        :root {
            --primary-blue: #29b6f6;
            --deep-blue: #0277bd;
            --ice-white: rgba(255, 255, 255, 0.85);
            --code-bg: #1e293b;
            --text-main: #334155;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--text-main);
            overflow-x: hidden;
            position: relative;
        }

        .snowflake {
            position: fixed;
            top: -10px;
            color: #fff;
            font-size: 1em;
            font-family: Arial;
            text-shadow: 0 0 1px #000;
            animation: fall linear infinite;
            z-index: 999;
            pointer-events: none;
        }

        @keyframes fall {
            0% {
                transform: translateY(-10vh) translateX(0);
                opacity: 1;
            }

            100% {
                transform: translateY(110vh) translateX(20px);
                opacity: 0;
            }
        }

        .container {
            width: 90%;
            max-width: 900px;
            background: var(--ice-white);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.6);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
            padding: 40px;
            margin: 40px 0;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 2px solid var(--primary-blue);
            padding-bottom: 20px;
        }

        h1 {
            color: var(--deep-blue);
            font-size: 3em;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 2px 2px 0px rgba(255, 255, 255, 0.5);
        }

        h2 {
            color: var(--primary-blue);
            font-weight: 300;
            margin-top: 10px;
            font-size: 1.5em;
        }

        .story-section {
            background: rgba(255, 255, 255, 0.5);
            border-left: 5px solid var(--primary-blue);
            padding: 20px;
            border-radius: 0 10px 10px 0;
            margin-bottom: 30px;
        }

        h3 {
            color: var(--deep-blue);
            display: flex;
            align-items: center;
        }

        h3::before {
            content: 'â„';
            margin-right: 10px;
            color: var(--primary-blue);
        }

        .math-box {
            background: #e1f5fe;
            padding: 15px;
            text-align: center;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 1.2em;
            border-radius: 8px;
            margin: 20px 0;
            border: 1px dashed var(--deep-blue);
        }

        .code-block {
            background-color: var(--code-bg);
            color: #a5b3ce;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            margin-bottom: 20px;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
            word-break: break-all;
        }

        .variable {
            color: #f07178;
        }

        .number {
            color: #c3e88d;
        }

        .comment {
            color: #546e7a;
            font-style: italic;
        }

        .hints {
            margin-top: 30px;
        }

        details {
            background: rgba(255, 255, 255, 0.6);
            border-radius: 8px;
            margin-bottom: 10px;
            overflow: hidden;
            border: 1px solid #b3e5fc;
        }

        summary {
            padding: 15px;
            cursor: pointer;
            font-weight: bold;
            color: var(--deep-blue);
            list-style: none;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        summary::after {
            content: '+';
            font-size: 1.2em;
        }

        details[open] summary::after {
            content: '-';
        }

        details[open] summary {
            background-color: #e1f5fe;
        }

        .hint-content {
            padding: 15px;
            color: #555;
            line-height: 1.6;
        }

        footer {
            text-align: center;
            margin-top: 50px;
            font-size: 0.8em;
            color: #78909c;
        }

        .highlight {
            background: #fff9c4;
            padding: 2px 5px;
            border-radius: 3px;
        }

        .cirno-class {
            margin-top: 40px;
            border-top: 2px dashed #b3e5fc;
            padding-top: 20px;
        }

        .cirno-class summary {
            background: linear-gradient(90deg, #4fc3f7, #29b6f6);
            color: white;
            border-radius: 50px;
            text-align: center;
            justify-content: center;
            border: none;
            box-shadow: 0 4px 10px rgba(41, 182, 246, 0.3);
            font-size: 1.1em;
        }

        .cirno-class summary::after {
            content: '';
            margin-left: 10px;
        }

        .cirno-class summary:hover {
            transform: translateY(-2px);
            transition: 0.2s;
        }

        .class-content {
            background: #e1f5fe;
            border-radius: 20px;
            padding: 25px;
            margin-top: 20px;
            position: relative;
            border: 2px solid #81d4fa;
        }

        .dialogue h4 {
            color: #01579b;
            margin-top: 0;
            font-size: 1.4em;
        }

        .lesson-block {
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .lesson-block h5 {
            margin: 0 0 10px 0;
            color: #0277bd;
            font-size: 1.1em;
            border-bottom: 2px solid #b3e5fc;
            display: inline-block;
        }

        .math-inline {
            background: #29b6f6;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.9em;
        }

        .secret-scroll {
            border: 2px dashed #f48fb1;
            background: #fff0f5;
        }

        .bow {
            width: 0;
            height: 0;
            border-left: 20px solid #29b6f6;
            border-top: 15px solid transparent;
            border-bottom: 15px solid transparent;
            position: absolute;
            top: -20px;
            left: -10px;
            transform: rotate(-15deg);
        }

        .bow::after {
            content: '';
            width: 0;
            height: 0;
            border-right: 20px solid #29b6f6;
            border-top: 15px solid transparent;
            border-bottom: 15px solid transparent;
            position: absolute;
            left: 2px;
            top: -15px;
        }
    </style>
</head>

<body>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            for (let i = 0; i < 30; i++) {
                let snow = document.createElement('div');
                snow.className = 'snowflake';
                snow.innerHTML = 'â„';
                snow.style.left = Math.random() * 100 + 'vw';
                snow.style.animationDuration = (Math.random() * 3 + 2) + 's';
                snow.style.opacity = Math.random();
                snow.style.fontSize = (Math.random() * 10 + 10) + 'px';
                document.body.appendChild(snow);
            }
        });
    </script>

    <div class="container">
        <header>
            <h1>å†°å†°è°œ 10</h1>
            <h2>CTF ä¹‹éå¯¹ç§°åŠ å¯†</h2>
        </header>

        <main>
            <div class="story-section">
                <h3>å¥‡æ€ªçš„èº«ä»½è¯</h3>
                <p>
                    çªéœ²è¯ºåœ¨é›¾ä¹‹æ¹–ç•”æ¡åˆ°äº†ä¸€å¼ ç¥ç§˜çš„èº«ä»½è¯ï¼Œä¸Šé¢çš„å·ç æ˜¯æ ‡å‡†çš„ <strong>18 ä½æ•°å­—</strong>ã€‚
                    ä½œä¸ºæœ€å¼ºçš„å¦–ç²¾ï¼Œå¥¹æ•é”åœ°å‘ç°è¿™ä¸ª ID å·ç è•´å«ç€é­”åŠ›ï¼Œå®ƒå¹¶ä¸æ˜¯éšæœºç”Ÿæˆçš„ï¼Œè€Œå¯ä»¥è¢«è¿™æ ·è´¨å› æ•°åˆ†è§£ï¼š
                </p>
                <div class="math-box">
                    ID = 2<sup>r</sup> Ã— s Ã— t
                </div>
                <p>
                    çªéœ²è¯ºä¸ºäº†è€ƒè€ƒä½ ï¼Œå°† s å’Œ t åˆ†åˆ«è—åœ¨äº†ä¸¤ä¸ª RSA è°œé¢˜ä¸­ã€‚
                    åªæœ‰è§£å¼€è°œé¢˜ï¼Œæ‰¾å‡º s å’Œ tï¼ŒæŒ‰å…¬å¼ç»„åˆï¼Œæ‰èƒ½å¾—åˆ°æœ€ç»ˆçš„ Flagã€‚
                </p>
                <p style="font-weight: bold; color: var(--deep-blue);">
                    Flag æ ¼å¼ï¼šcirno{ID} (å³è¿˜åŸåçš„18ä½ID)
                </p>
            </div>

            <h3>ğŸ”’ RSA é¢˜ç›®</h3>

            <div class="code-block">
                # ---------------- Part 1: Find s ----------------<br>
                # The exponent is unusually large...<br>
                N1 =
                116702217978146602128173689090166993337176352956979618777061562262940986240029967402153277151166311640678331672476195574435263792695012209372537632814258799288953982614025902870200404144931634729366634675534675755289794140165917030101680129718230607792865599349930303140744532866167872466968669054239806488473<br>
                e1 =
                102158699137890895126616631603486063802083239071421408259451107284846400491138420655692781543705215524038296856999721079888640108402082796556118779379801161931585949735940169186898600987311368205792784952721990519584968869982781715703928793372419887733047855865410546547704246650319574368930746130793163725745<br>
                c1 =
                48703461961995655489468586574799563141645698813163274716826673140304747135684227783429359476985744333873820416437815728785495758961748425712410228977828721456834287677352962060705249325078687586066129853947070945161626728456921237172004557572698384172302698476975622370513077282839761187220758828612188904671<br>

                # ---------------- Part 2: Find t ----------------<br>
                # Two modulus generated at the same time...<br>
                N2 =
                109828612612338364224140678138681553446177305161432996376860592663252385707595330588811136637127466116219923839120758352774442930300059997087835771078623057018898975098298587674276348428812139581840708692442149689030745818494075091552554475130244627728039856568356312600500171470171296803690228832618149961693<br>
                N3 =
                139711526054164893580799676981622714474865010975403234432228040182484833729872667485211162012941366739752734451830261930032423284968082040802238917438334136352896086505653686842145511471511153079267010884686977370657895805083451085263668197244063489640083109317673139572817629194777161189048356808149817378777<br>
                e2 = 65537<br>
                c2 =
                67304970598704489753252956871570667821452688985945798888413988553248479341156030509770744961092095528371531899128455252187642287302979325955118909165746793278394734100448314889971010675361860485958236667354682000128209847602452339767156593735647154678687811984294618984100360234832256552531809431401497507826
            </div>

            <div class="hints">
                <h3>ğŸ’¡ Hints</h3>

                <details>
                    <summary>æç¤º 1ï¼šå…³äº s çš„è·å–</summary>
                    <div class="hint-content">
                        åœ¨ç¬¬ä¸€éƒ¨åˆ†ä¸­ï¼Œæ¨¡æ•° N1 æ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯å…¬é’¥ e1 éå¸¸å¤§ï¼ˆæ¥è¿‘ N1 çš„å¤§å°ï¼‰ã€‚<br>
                        åœ¨ RSA ä¸­ï¼Œå½“ <strong>e å¾ˆå¤§</strong>æ—¶ï¼Œå¾€å¾€æ„å‘³ç€ <strong>d (ç§é’¥) å¾ˆå°</strong>ã€‚<br>
                        ä½ å¯ä»¥å»æŸ¥é˜…ä¸€ä¸‹ <em>Wiener's Attack (ç»´çº³æ”»å‡»)</em>ã€‚
                    </div>
                </details>

                <details>
                    <summary>æç¤º 2ï¼šå…³äº t çš„è·å–</summary>
                    <div class="hint-content">
                        ä½ å¾—åˆ°äº†ä¸¤ä¸ªæ¨¡æ•° N2 å’Œ N3ã€‚<br>
                        åœ¨ç”Ÿæˆ RSA å¯†é’¥æ—¶ï¼Œå¦‚æœéšæœºæ•°ç”Ÿæˆå™¨å·æ‡’äº†ï¼Œæˆ–è€…ä¸ºäº†èŠ‚çœèµ„æºï¼Œ
                        æœ‰æ—¶å€™ä¸åŒçš„æ¨¡æ•°ä¼š<strong>å…±äº«åŒä¸€ä¸ªç´ æ•°å› å­</strong>ã€‚<br>
                        è¯•ç€è®¡ç®—ä¸€ä¸‹ GCD(N2, N3) çœ‹çœ‹ï¼Ÿ
                    </div>
                </details>

                <details>
                    <summary>æç¤º 3ï¼šæœ€ç»ˆçš„ ID</summary>
                    <div class="hint-content">
                        å½“ä½ æ‹¿åˆ° s å’Œ t åï¼Œåˆ«å¿˜äº†é¢˜ç›®ä¸€å¼€å§‹ç»™å‡ºçš„å…¬å¼ã€‚<br>
                        ID = 2^r * s * t<br>
                        ä½ åº”å½“å¯ä»¥æ ¹æ®IDæ˜¯ä¸€ä¸ªèº«ä»½è¯å·å¾—åˆ°rå’ŒIDã€‚
                    </div>
                </details>
            </div>
        </main>

        <div class="cirno-class">
            <details>
                <summary>â„ï¸ æä¸æ‡‚ RSAï¼Ÿè¿›æ¥çœ‹çªéœ²è¯ºè€å¸ˆçš„å®Œç¾ç®—æœ¯æ•™å®¤ï¼ â„ï¸</summary>
                <div class="class-content">
                    <div class="avatar">
                        <div class="bow"></div>
                    </div>
                    <div class="dialogue">
                        <h4>æˆ‘æ˜¯å¤©æ‰çªéœ²è¯ºï¼å¬å¥½äº†ï¼</h4>
                        <p>
                            å“¼å“¼ï¼Œçœ‹æ¥ä½ è¢«è¿™äº›æ•°å­—å†»ä½äº†å‘¢ï¼<br>
                            æ—¢ç„¶ä½ è¯šå¿ƒè¯šæ„åœ°å‘é—®äº†ï¼Œæœ€å¼ºçš„æˆ‘å°±å¤§å‘æ…ˆæ‚²åœ°å‘Šè¯‰ä½  <strong>RSA</strong> æ˜¯æ€ä¹ˆå›äº‹ï¼
                        </p>

                        <div class="lesson-block">
                            <h5>1. ä¸¤ä¸ªç¥å¥‡çš„ç´ æ•° (p å’Œ q)</h5>
                            <p>
                                RSA çš„é­”æ³•æ ¸å¿ƒå°±æ˜¯ä¸¤ä¸ªå¤§å¤§çš„ç´ æ•°ï¼Œæˆ‘ä»¬å«å®ƒä»¬ <strong>p</strong> å’Œ <strong>q</strong>ã€‚<br>
                                æŠŠå®ƒä»¬ä¹˜èµ·æ¥ï¼š<span class="math-inline">N = p Ã— q</span>ã€‚<br>
                                è¿™å°±åƒæŠŠä¸¤ä¸ªé›ªçƒææˆäº†ä¸€ä¸ªå·¨å¤§çš„é›ªäºº (N)ã€‚åˆ«äººçœ‹åˆ°é›ªäººï¼Œæ ¹æœ¬çŒœä¸å‡ºå®ƒåŸæœ¬æ˜¯å“ªä¸¤ä¸ªé›ªçƒç»„æˆçš„ï¼<br>
                                <span class="highlight">è¿™å°±æ˜¯ RSA å®‰å…¨çš„åŸå› ï¼šæ‹†é›ªäººï¼ˆåˆ†è§£ Nï¼‰å¤ªéš¾å•¦ï¼</span>
                            </p>
                        </div>

                        <div class="lesson-block">
                            <h5>2. é”å’Œé’¥åŒ™ (e å’Œ d)</h5>
                            <p>
                                æˆ‘ä»¬è¦é€æƒ…æŠ¥ï¼Œéœ€è¦ä¸€æŠŠé”ï¼ˆå…¬é’¥ <strong>e</strong>ï¼‰å’Œä¸€æŠŠé’¥åŒ™ï¼ˆç§é’¥ <strong>d</strong>ï¼‰ã€‚<br>
                            <ul>
                                <li><strong>åŠ å¯†ï¼š</strong> ç”¨ e æŠŠæƒ…æŠ¥é”è¿›ç›’å­ã€‚ <span class="math-inline">c = m^e mod N</span>
                                </li>
                                <li><strong>è§£å¯†ï¼š</strong> ç”¨ d æŠŠç›’å­æ‰“å¼€ã€‚ <span class="math-inline">m = c^d mod N</span></li>
                            </ul>
                            e å’Œ d æ˜¯æ•°å­¦ä¸Šçš„ä¸€å¯¹å¥½æœ‹å‹ï¼Œå®ƒä»¬æ»¡è¶³ä¸€ä¸ªç¥ç§˜çš„çº¦å®šã€‚åªè¦ç®—å‡º dï¼Œä½ å°±èƒ½æˆä¸ºæœ€å¼ºï¼
                            </p>
                        </div>

                        <div class="lesson-block">
                            <h5>3. é”å’Œé’¥åŒ™çš„ç§˜å¯†çº¦å®š (æ¨¡é€†å…ƒ)</h5>
                            <p>
                                e (å…¬é’¥) å’Œ d (ç§é’¥) å¯ä¸æ˜¯éšä¾¿é€‰çš„æ•°å­—ï¼å®ƒä»¬æ˜¯ä¸€å¯¹<strong>â€œæ¨¡é€†å…ƒâ€</strong>ã€‚
                            </p>
                            <p>
                                <span class="highlight">å…³é”®å…¬å¼ï¼še Ã— d â‰¡ 1 (mod Ï†(N))</span>
                            </p>
                            <p
                                style="border-left: 3px solid #f48fb1; padding-left: 10px; margin-top: 10px; background: rgba(255,255,255,0.5);">
                                <strong>æ€ä¹ˆç®— dï¼Ÿ</strong><br>
                                åœ¨ Python é‡Œï¼Œç›´æ¥ç”¨å’’è¯­ <code style="color: #d81b60;">d = inverse(e, phi)</code>ï¼Œç”µè„‘å°±ä¼šå¸®ä½ ç®—å‡ºé€†å…ƒï¼
                            </p>
                        </div>

                        <p style="text-align: center; font-weight: bold; color: var(--deep-blue);">
                            æ‡‚äº†å—ï¼Ÿå¿«å»è§£å¼€é¢˜ç›®ï¼Œè¯æ˜ä½ æ¯”å†°ä¹‹å¦–ç²¾è¿˜èªæ˜å§ï¼<br>
                            å¦‚æœè¿˜æ˜¯ä¸ä¼šâ€¦â€¦å»è®©å¤§æ¨¡å‹å¸®å¸®ä½ è§£é¢˜å§ï¼
                        </p>
                    </div>
                </div>
            </details>
        </div>

        <footer>
            <p>Â© Hypergeometry Ice Fairy</p>
        </footer>
    </div>

</body>

</html>